<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>TrueSight ‚Äî IP Finder</title>
  <style>
    body {
      background: linear-gradient(135deg, #0a0a14, #1a1a2e);
      color: #fff;
      font-family: "Segoe UI", Arial, sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
    }
    .card {
      background: #1b1b2f;
      padding: 40px;
      border-radius: 20px;
      width: 550px;
      text-align: center;
      box-shadow: 0px 8px 25px rgba(0, 0, 0, 0.6);
      transition: transform 0.3s ease;
    }
    .card:hover {
      transform: translateY(-5px);
    }
    h2 {
      font-size: 28px;
      margin-bottom: 10px;
      color: #c8a2ff;
    }
    p.subtitle {
      font-size: 15px;
      color: #aaa;
      margin-bottom: 25px;
    }
    button {
      padding: 14px 28px;
      margin: 8px;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      font-weight: bold;
      font-size: 16px;
      transition: all 0.1s ease-in-out;
    }
    .btn-find {
      background: #7a3cff;
      color: #fff;
      box-shadow: 0px 4px 12px rgba(122, 60, 255, 0.6);
    }
    .btn-find:hover {
      background: #9a60ff;
      transform: scale(1.05);
      box-shadow: 0px 6px 16px rgba(122, 60, 255, 0.8);
    }
    .btn-find:active {
      transform: scale(0.97);
    }
    .btn-copy {
      background: #2c2c44;
      color: #fff;
      box-shadow: 0px 4px 10px rgba(0,0,0,0.4);
    }
    .btn-copy:hover {
      background: #3a3a5a;
      transform: scale(1.05);
    }
    .btn-copy:active {
      transform: scale(0.97);
    }
    .info {
      margin-top: 20px;
      text-align: left;
    }
    .info p {
      background: #2a2a40;
      padding: 12px;
      border-radius: 10px;
      font-size: 15px;
      margin: 8px 0;
    }
    .note {
      margin-top: 18px;
      font-size: 13px;
      color: #bbb;
      line-height: 1.4;
    }
  </style>
</head>
<body>
  <div class="card">
    <h2>TrueSight ‚Äî IP Finder</h2>
    <p class="subtitle">Click the button to discover live network info (runs in your browser)</p>
    <button class="btn-find" onclick="findIP()">üîé Find My IP</button>
    <button class="btn-copy" onclick="copyIP()">Copy Public IP</button>
    <div class="info">
      <p><strong>Hostname:</strong> <span id="hostname">‚Äî</span></p>
      <p><strong>Local IPs:</strong> <span id="localIP">‚Äî</span></p>
      <p><strong>Outbound (primary) IP:</strong> <span id="outboundIP">‚Äî</span></p>
      <p><strong>Public IP (detected):</strong> <span id="publicIP">‚Äî</span></p>
      <p><strong>Reverse DNS for public IP:</strong> <span id="reverseDNS">‚Äî</span></p>
    </div>
    <p class="note">
      Notes: Browser JS can‚Äôt reliably get the OS hostname; local IPs may be exposed via WebRTC but can be blocked.  
      Reverse DNS relies on public DNS and is often limited by CORS restrictions.
    </p>
  </div>

  <script>
    let detectedIP = "";

    function setLoading() {
      document.getElementById("hostname").textContent = "Detecting...";
      document.getElementById("localIP").textContent = "Detecting...";
      document.getElementById("outboundIP").textContent = "Detecting...";
      document.getElementById("publicIP").textContent = "Detecting...";
      document.getElementById("reverseDNS").textContent = "Detecting...";
    }

    async function findIP() {
      setLoading();

      // Public IP
      try {
        const res = await fetch("https://api64.ipify.org?format=json");
        const data = await res.json();
        detectedIP = data.ip;
        document.getElementById("publicIP").textContent = detectedIP;
        document.getElementById("outboundIP").textContent = detectedIP;
      } catch {
        document.getElementById("publicIP").textContent = "Error";
      }

      // Local IPs via WebRTC
      try {
        let localIPs = new Set();
        let pc = new RTCPeerConnection({iceServers:[]});
        pc.createDataChannel("");
        pc.createOffer().then(offer => pc.setLocalDescription(offer));

        pc.onicecandidate = (ice) => {
          if (ice && ice.candidate && ice.candidate.candidate) {
            const ipMatch = ice.candidate.candidate.match(/([0-9]{1,3}(\.[0-9]{1,3}){3})/);
            if (ipMatch) {
              localIPs.add(ipMatch[1]);
              document.getElementById("localIP").textContent = Array.from(localIPs).join(", ");
            }
          }
        };

        setTimeout(() => {
          if (localIPs.size === 0) {
            document.getElementById("localIP").textContent = "Blocked/Unavailable";
          }
        }, 2000);
      } catch {
        document.getElementById("localIP").textContent = "Blocked";
      }

      // Hostname
      document.getElementById("hostname").textContent = window.location.hostname || "Unavailable";

      // Reverse DNS lookup
      if (detectedIP) {
        try {
          const rdns = await fetch(`https://dns.google/resolve?name=${detectedIP}.in-addr.arpa&type=PTR`);
          const rdnsData = await rdns.json();
          if (rdnsData.Answer && rdnsData.Answer[0]) {
            document.getElementById("reverseDNS").textContent = rdnsData.Answer[0].data;
          } else {
            document.getElementById("reverseDNS").textContent = "Not available";
          }
        } catch {
          document.getElementById("reverseDNS").textContent = "Error";
        }
      }
    }

    function copyIP() {
      if (detectedIP) {
        navigator.clipboard.writeText(detectedIP);
        alert("‚úÖ Public IP copied: " + detectedIP);
      } else {
        alert("‚ö†Ô∏è No IP detected yet. Click 'Find My IP' first.");
      }
    }
  </script>
</body>
</html>
