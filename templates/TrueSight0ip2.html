<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>TrueSight â€” IP Finder</title>
  <style>
    body {
      background: #0f0f1a;
      color: #fff;
      font-family: Arial, sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }
    .card {
      background: #1b1b2f;
      padding: 30px;
      border-radius: 12px;
      width: 420px;
      text-align: center;
      box-shadow: 0px 4px 12px rgba(0,0,0,0.5);
    }
    button {
      padding: 10px 20px;
      margin: 5px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
    }
    .btn-find {
      background: #7a3cff;
      color: #fff;
    }
    .btn-copy {
      background: #333;
      color: #fff;
    }
    .info {
      margin-top: 15px;
      text-align: left;
    }
    .info p {
      background: #2a2a40;
      padding: 8px;
      border-radius: 6px;
      font-size: 14px;
    }
  </style>
</head>
<body>
  <div class="card">
    <h2>TrueSight â€” IP Finder</h2>
    <p>Click the button to discover live network info (runs in your browser)</p>
    <button class="btn-find" onclick="findIP()">ðŸ”Ž Find My IP</button>
    <button class="btn-copy" onclick="copyIP()">Copy Public IP</button>
    <div class="info">
      <p><strong>Hostname:</strong> <span id="hostname">â€”</span></p>
      <p><strong>Local IPs:</strong> <span id="localIP">â€”</span></p>
      <p><strong>Outbound (primary) IP:</strong> <span id="outboundIP">â€”</span></p>
      <p><strong>Public IP (detected):</strong> <span id="publicIP">â€”</span></p>
      <p><strong>Reverse DNS for public IP:</strong> <span id="reverseDNS">â€”</span></p>
    </div>
    <p style="margin-top:10px; font-size:12px; color:#bbb;">
      Notes: Browser JS canâ€™t reliably get the OS hostname; local IPs may be exposed via WebRTC but can be blocked. Reverse DNS relies on public DNS and is often limited by CORS restrictions.
    </p>
  </div>

  <script>
    let detectedIP = "";

    function setLoading() {
      document.getElementById("hostname").textContent = "Detecting...";
      document.getElementById("localIP").textContent = "Detecting...";
      document.getElementById("outboundIP").textContent = "Detecting...";
      document.getElementById("publicIP").textContent = "Detecting...";
      document.getElementById("reverseDNS").textContent = "Detecting...";
    }

    async function findIP() {
      setLoading();

      // Public IP
      try {
        const res = await fetch("https://api64.ipify.org?format=json");
        const data = await res.json();
        detectedIP = data.ip;
        document.getElementById("publicIP").textContent = detectedIP;
        document.getElementById("outboundIP").textContent = detectedIP;
      } catch {
        document.getElementById("publicIP").textContent = "Error";
      }

      // Local IP via WebRTC (better parser)
      try {
        let localIPs = new Set();
        let pc = new RTCPeerConnection({iceServers:[]});
        pc.createDataChannel("");
        pc.createOffer().then(offer => pc.setLocalDescription(offer));

        pc.onicecandidate = (ice) => {
          if (ice && ice.candidate && ice.candidate.candidate) {
            const ipMatch = ice.candidate.candidate.match(/([0-9]{1,3}(\.[0-9]{1,3}){3})/);
            if (ipMatch) {
              localIPs.add(ipMatch[1]);
              document.getElementById("localIP").textContent = Array.from(localIPs).join(", ");
            }
          }
        };

        setTimeout(() => {
          if (localIPs.size === 0) {
            document.getElementById("localIP").textContent = "Blocked/Unavailable";
          }
        }, 2000);
      } catch {
        document.getElementById("localIP").textContent = "Blocked";
      }

      // Hostname
      document.getElementById("hostname").textContent = window.location.hostname || "Unavailable";

      // Reverse DNS lookup
      if (detectedIP) {
        try {
          const rdns = await fetch(`https://dns.google/resolve?name=${detectedIP}.in-addr.arpa&type=PTR`);
          const rdnsData = await rdns.json();
          if (rdnsData.Answer && rdnsData.Answer[0]) {
            document.getElementById("reverseDNS").textContent = rdnsData.Answer[0].data;
          } else {
            document.getElementById("reverseDNS").textContent = "Not available";
          }
        } catch {
          document.getElementById("reverseDNS").textContent = "Error";
        }
      }
    }

    function copyIP() {
      if (detectedIP) {
        navigator.clipboard.writeText(detectedIP);
        alert("Public IP copied: " + detectedIP);
      } else {
        alert("No IP detected yet. Click 'Find My IP' first.");
      }
    }
  </script>
</body>
</html>
